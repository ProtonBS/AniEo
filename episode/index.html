<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ani.MoM - Episode Details</title>
    <link rel="icon" type="image/x-icon" href="./favicon.ico" />
    <script defer data-domain="ani.mom" src="https://plausible.io/js/script.js"></script>
    <meta name="google-site-verification" content="UIoh-JOgvqutTOTeeKOEOjy6gAZ2RKeFXsHUDCAioNo" />
    
  <!--ShareThis-->
    <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=673480d151224300122167a2&product=sop' async='async'></script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Plyr CSS -->
    <link href="https://cdn.jsdelivr.net/npm/plyr@3.7.2/dist/plyr.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/plyr@3.7.2/dist/plyr.polyfilled.js"></script>
    <style>
        body {
            background-color: #121212;
            color: white;
        }
        .header {
            background-color: #1c1c1c;
            padding: 1rem;
            border-bottom: 2px solid #333;
        }
        .header h1 {
            font-size: 1.75rem;
            font-weight: bold;
            letter-spacing: 2px;
            color: #d5eb34;
        }
        .search-box {
            max-width: 150px;  /* Making the search box smaller */
        }
        .video-container {
            max-width: 100%;
            height: 80vh;
            margin: 0 auto;
            text-align: center;
            padding: 2rem 0;
        }
        #player {
            width: 100%;
            height: 100%;
        }
        .currently-playing {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 1rem;
        }
        .currently-playing strong {
            color: #d5eb34;
            font-weight: bold;
        }
        .buttons-container {
            margin-top: 1rem;
        }
        .btn-custom {
            background-color: #333;
            color: #d5eb34;
            border: none;
            width: 120px;
            margin: 0.5rem;
        }
        .btn-custom:hover {
            background-color: #444;
            color: #fff;
        }
        .btn-outline-custom {
            border: 2px solid #d5eb34;
            color: #d5eb34;
            width: 120px;
            margin: 0.5rem;
        }
        .btn-outline-custom:hover {
            background-color: #d5eb34;
            color: #121212;
        }
        footer {
            background-color: #1c1c1c;
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
        }
        /* Style for the scrollable episode box */
        .scrollable-episodes {
            display: flex;
            overflow-x: auto;
            margin-top: 1rem;
          
            padding: 1rem 0;
            gap: 1rem;
        }
        .episode-button {
            background-color: #333;
            color: #d5eb34;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            min-width: 100px;
        }
        .episode-button:hover {
            background-color: #444;
            color: #fff;
        }
        .download-button {
    background-color: #444;
    color: #d5eb34;
    border: none;
    padding: 0.5rem 1rem;
    margin-top: 0;
    border-radius: 5px;
    width: 200px;
}

        .download-button:hover {
            background-color: #555;
            color: #fff;
        }
        /* Timer style */
        #timer {
            font-size: 0.8rem;
            color: #fff;
            margin-top: 1rem;
        }
      
     

      
    </style>
</head>
<body>

   <!-- Header Section -->
    <header class="header d-flex justify-content-between align-items-center">
        <h1>Ani.MoM</h1>
        <!-- Updated search form -->
        <form action="/search/" method="get" class="search-box">
            <input type="text" name="q" class="form-control" placeholder="Search..." aria-label="Search" required>
        </form>
    </header>

  
  <center>
  <div id="frame" style="width: 320px;"><iframe data-aa='2358407' src='//ad.a-ads.com/2358407?size=320x100' style='width:320px; height:100px; border:0px; padding:0; overflow:hidden; background-color: transparent;'></iframe><a style="display: block; text-align: right; font-size: 12px" id="frame-link" href="https://aads.com/campaigns/new/?source_id=2358407&source_type=ad_unit&partner=2358407">Advertise here</a></div>

  </center>
       
    <!-- Video Player Section -->
    <div class="container video-container">
      <!-- ShareThis BEGIN --><div class="sharethis-inline-share-buttons"></div><!-- ShareThis END -->
        <video id="player" controls>
            <source id="video-source" type="application/x-mpegURL" src="">
        </video>
        <!-- "Currently Playing" text below the player -->
        <div class="currently-playing">
            <p id="currently-playing-text">Currently Playing : <strong></strong></p>
        </div>

        <!-- Quality buttons -->
        <div class="buttons-container text-center" id="quality-buttons"></div>

        <!-- Previous & Next buttons below quality buttons -->
        <div class="d-flex justify-content-center mt-4">
            <button id="previous-button" class="btn btn-outline-custom">Previous</button>
            <button id="next-button" class="btn btn-outline-custom">Next</button>
        </div>
      
      
      

        <!-- Scrollable episode buttons -->
        <div class="scrollable-episodes" id="episode-buttons-container"></div>
    </div>
  
  <center>
        <script type="text/javascript">
	atOptions = {
		'key' : 'f5944715842e6425397e93e3277a8eab',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/f5944715842e6425397e93e3277a8eab/invoke.js"></script></center><br>
  
  
  <!-- Download This Episode Button -->
        <div class="d-flex justify-content-center">
            <button id="download-button" class="download-button">Download This Episode</button>
        </div>

        <!-- Timer display -->
        <div class="text-center" id="timer" style="display: none;">Please Wait - <span id="countdown"></span>
  
          <script async="async" data-cfasync="false" src="//pl24130887.profitablecpmrate.com/657db0b8ba53f63b5fb3ba094fe13923/invoke.js"></script>
<div id="container-657db0b8ba53f63b5fb3ba094fe13923"></div>
  
  </div>
  

    <!--𝗧𝗲𝗹𝗲𝗴𝗿𝗮𝗺--><center><br>
<script type="text/javascript">(function() {var script=document.createElement("script");script.type="text/javascript";script.async =true;script.src="//telegram.im/widget-button/index.php?id=@zoronewera";document.getElementsByTagName("head")[0].appendChild(script);})();</script>
<a href="https://telegram.dog/zoronewera" target="_blank" class="telegramim_button telegramim_shadow telegramim_pulse" style="font-size:12px;width:260px;background:#a7f211;box-shadow:1px 1px 5px #a7f211;color:#000000;border-radius:50px;" title=""><i></i> Report A Problem On Telegram</a>
<!--𝗧𝗲𝗹𝗲𝗴𝗿𝗮𝗺--></center> <br>
  
  

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        
      
    // Get the 'id' parameter from the URL
    const urlParams = new URLSearchParams(window.location.search);
    
    // Extract query and episode number, ensuring the query is properly encoded and parsed
    const fullId = urlParams.get('id');
    const query = encodeURIComponent(fullId.split('-episode-')[0]);  // Encode the anime name
    const episodeNumber = fullId.split('-episode-')[1];  // Extract episode number

    // Dynamically display the "Currently Playing" text based on the query
    const currentlyPlayingText = document.getElementById('currently-playing-text');
    const currentlyPlayingStrong = currentlyPlayingText.querySelector('strong');
    currentlyPlayingStrong.textContent = `${query.charAt(0).toUpperCase() + query.slice(1)} (Episode - ${episodeNumber})`;

    // Set Previous and Next URLs
    const previousEpisode = parseInt(episodeNumber) - 1;
    const nextEpisode = parseInt(episodeNumber) + 1;
    const previousUrl = `https://ani.mom/episode/?id=${query}-episode-${previousEpisode}`;
    const nextUrl = `https://ani.mom/episode/?id=${query}-episode-${nextEpisode}`;

    document.getElementById('previous-button').onclick = function() {
        window.location.href = previousUrl;
    };
    document.getElementById('next-button').onclick = function() {
        window.location.href = nextUrl;
    };

    // Download button functionality with timer
    const downloadButton = document.getElementById('download-button');
    downloadButton.onclick = function() {
        const timerDisplay = document.getElementById('timer');
        const countdownElement = document.getElementById('countdown');
        
        // Hide the download button and show the timer
        downloadButton.style.display = 'none';
        timerDisplay.style.display = 'block';
        
        let countdown = 9;
        countdownElement.textContent = countdown;
        
        const interval = setInterval(function() {
            countdown -= 1;
            countdownElement.textContent = countdown;
            
            if (countdown <= 0) {
                clearInterval(interval);
                // Redirect to download page after 3 seconds
                window.location.href = `/dl/?id=${query}-episode-${episodeNumber}`;
            }
        }, 1000);
    };

    // Fetch the video URL for the current episode and quality options
    const videoUrlApi = `https://animetize-api.vercel.app/watch/${query}-episode-${episodeNumber}`;
    fetch(videoUrlApi)
        .then(response => response.json())
        .then(data => {
            const videoSource = document.getElementById('video-source');
            const qualityButtonsContainer = document.getElementById('quality-buttons');

            // Set default video source (highest quality)
            videoSource.src = data.sources.find(source => source.quality === '1080p')?.url || data.sources[0].url;

            // Initialize Plyr player with the default source
            const player = new Plyr('#player');
            player.source = {
                type: 'video',
                sources: [{
                    src: videoSource.src,
                    type: 'video/mp4'
                }]
            };

            // Create quality buttons dynamically
            data.sources.forEach((source) => {
                const button = document.createElement('button');
                button.className = 'btn btn-custom';
                button.textContent = source.quality;
                button.onclick = function () {
                    videoSource.src = source.url;  // Set the selected quality

                    // Update Plyr player source when a new quality is selected
                    player.source = {
                        type: 'video',
                        sources: [{
                            src: videoSource.src,
                            type: 'video/mp4'
                        }]
                    };

                    player.play();  // Restart video with the new source
                };
                qualityButtonsContainer.appendChild(button);
            });
        })
        .catch(error => {
            console.error('Error fetching video source:', error);
            // Optionally handle errors (e.g., show an error message to the user)
        });

    // Fetch episode list for scrolling buttons
    const episodeListApi = `https://animetize-api.vercel.app/info/${query}`;
    fetch(episodeListApi)
        .then(response => response.json())
        .then(data => {
            const episodeButtonsContainer = document.getElementById('episode-buttons-container');
            data.episodes.forEach(episode => {
                const episodeButton = document.createElement('button');
                episodeButton.className = 'episode-button';
                episodeButton.textContent = `Ep${episode.number}`;
                episodeButton.onclick = function() {
                    window.location.href = `https://ani.mom/episode/?id=${query}-episode-${episode.number}`;
                };
                episodeButtonsContainer.appendChild(episodeButton);
            });
        })
        .catch(error => {
            console.error('Error fetching episode list:', error);
            // Optionally handle errors (e.g., show an error message to the user)
        });
</script>

   
</body>
</html>
